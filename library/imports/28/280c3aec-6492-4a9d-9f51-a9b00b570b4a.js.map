{"version":3,"sources":["../../../../assets/script/assets/script/aStart.js"],"names":["AstarControl","require","iconConf","canGo","startPoint","endPoint","onCan","cc","Class","extends","Component","properties","label","default","type","Label","errorLabel","Node","iconPrebef","Prefab","contentNode","onLoad","StartPoint","EntPoint","comArr","astarControl","getInstance","start","click","getRound","currentPoint","currentX","x","currentY","y","rows","push","data","length","init","startArray","len","width","i","tempArray","j","cellData","cellPrefeb","instantiate","parent","com","getComponent","F","G","EndPoint","clearAll","clear","_clickPath","isIng","path","GetPath","active","log","JSON","stringify","xL","getxL","num","setInterval","itemData","setColor","onClickPath","btn","flag","parseInt","isTrue"],"mappings":"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","file":"aStart.js","sourceRoot":"../../../../assets/script","sourcesContent":["let AstarControl = require('aStartController');\n\nconst iconConf = {\n    canGo:0,\n    startPoint:1,\n    endPoint:2,\n    onCan:3,\n}\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        label: {\n            default: null,\n            type: cc.Label\n        },\n        errorLabel:cc.Node,\n        iconPrebef:cc.Prefab,\n        contentNode:cc.Node\n    },\n\n    onLoad: function () {\n        this.StartPoint = null;\n        this.EntPoint =null;\n        this.comArr = [];\n        this.astarControl = AstarControl.getInstance(this);\n    },\n\n    start(){\n        this.astarControl.start();\n        this.click = false;\n    },\n      //获取周边的点\n      getRound(currentPoint){\n        let currentX = currentPoint.x;\n        let currentY = currentPoint.y;\n        let rows = [];\n        if(currentPoint.y - 1 >= 0){//上\n            rows.push({x:currentX, y: currentY - 1});\n        }\n        if(currentPoint.y + 1 < this.data.length){ //下\n            rows.push({x:currentX, y: currentY + 1});\n        }\n\n        if(currentPoint.x - 1 >= 0){ //左\n            rows.push({x:currentX - 1, y: currentY});\n        }\n\n        if(currentPoint.x + 1 < this.data[0].length){ //右\n            rows.push({x:currentX + 1, y: currentY});\n        }\n\n        return rows;\n    },\n    \n    init(startArray){\n        this.startArray = startArray;\n        let len = startArray[0].length;\n        this.contentNode.width = len * 35;\n        for(let i = 0; i < startArray.length; i++){\n            let tempArray = startArray[i];\n            this.comArr[i]= []\n            for(let j = 0; j < tempArray.length; j++){\n                let cellData = tempArray[j];\n                let cellPrefeb =  cc.instantiate(this.iconPrebef);\n                cellPrefeb.parent = this.contentNode;\n                let com = cellPrefeb.getComponent(\"iconView\");\n                let data = {x:i,y:j,F:0,G:0,data:cellData}\n                if(cellData == -1){\n                    this.StartPoint = {x:i,y:j,F:0,G:0};\n                }\n                if(cellData == -2){\n                    this.EndPoint = {x:i,y:j,F:0,G:0};\n                }\n                com && com.init(data);\n                this.comArr[i][j]=com;\n            }\n        }\n    },\n\n    clearAll(){\n        for(let i = 0; i < this.startArray.length; i++){\n            let tempArray = this.startArray[i];\n            for(let j = 0; j < tempArray.length; j++){\n                let com = this.comArr[i][j];\n                com && com.clear()\n            }\n        }\n    },\n\n    _clickPath(isIng){\n        if(this.click){\n            this.clearAll();\n        }\n        this.click = true;\n        let path = this.astarControl.GetPath(this.StartPoint, this.EndPoint, isIng);\n        if(!path || path.length==0){\n            this.errorLabel.active = true;\n            return;\n        } else{\n            this.errorLabel.active = false;\n        }\n         cc.log(\"path:\"+JSON.stringify(path));\n        let xL = this.astarControl.getxL();\n        let i = 0;\n        let num = path.length;\n        setInterval(()=>{\n            if(path[i]){\n                let itemData = path[i];\n                let x = itemData.x;\n                let y = itemData.y;\n                let num = x*xL + y;\n              ;  let com = this.comArr[x][y];\n                com && com.setColor()\n            }\n            i++;\n        },500);\n    },\n\n    onClickPath(btn, data){\n        let flag = parseInt(data);\n        let isTrue = flag?true:false;\n        this._clickPath(flag)\n    }\n});\n"]}